---
- hosts: "{{ target }}"
  become: yes
  gather_facts: true
  ignore_errors: yes
  vars_files:
    - config.yml
    - vault.yml
  vars:
    - ansible_become_pass: '{{ su_password }}'

- name: Setting up Raspberry Pi / Pi
  hosts: pi
  become: yes
  collections:
    - rafaelktistakis.pi
    - rafaelktistakis.linux
    - devsec.hardening
  roles:
    - pisetup
    - packages
    - overclock
    - plex
    - starship
    # - usbc-gadget
    # - docker
    # - code-tunnel
    # - fstab-umask-fix
#    - os_hardening
  #  - ssh_hardening
  vars_files:
    - config.yml
    - vault.yml
  vars:
    - ansible_become_pass: '{{ su_password }}'
  pre_tasks:
    - name: verify git installation
      package: name=git state=present

- name: Setting up Pi Zero 2 / Ocarina - Fi
  hosts: 
    - ocarina
    - fi
  become: yes
  collections:
    - rafaelktistakis.pi
    - rafaelktistakis.dietpi
    - devsec.hardening
  roles:
    - dietpisetup
  vars_files:
    - config.yml
    - vault.yml
  vars:
    - ansible_become_pass: '{{ su_password }}'
  pre_tasks:
    - name: verify git installation
      package: name=git state=present
    - name: Verify OpenSsh installation
      package: name=openssh-server state=present



  # task:

#    - name: rtorrent setup
#      become: yes
#      import_tasks: playbooks/qbittorrent-setup.yml
#    - name: Tmux setup
#      become: yes
#      import_tasks: playbooks/tmux-setup.yml
  #  - name: Homebridge setup
  #    become: yes
  #    import_tasks: playbooks/homebridge-setup.yml
